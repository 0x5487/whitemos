FROM alpine:3.5
LABEL owner="Jason Lee"

ENV WHITEMOS_ENV=production

RUN apk update && \
    apk upgrade && \
    apk add --no-cache curl && \
    rm -rf /var/cache/apk/* && \
    mkdir -p /jasonsoft/whitemos

ADD whitemos /jasonsoft/whitemos/whitemos 
ADD views /jasonsoft/whitemos/views

WORKDIR /jasonsoft/whitemos
CMD ./whitemos

HEALTHCHECK --interval=5s --timeout=10s CMD curl -f http://localhost/health || exit 1